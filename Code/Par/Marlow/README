Borrowed from Simon Marlow's tutorial
http://github.com/simonmar/par-tutorial
Usage according to licence in the LICENCE file
